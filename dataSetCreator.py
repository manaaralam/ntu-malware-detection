# -*- coding: utf-8 -*-
"""
Created on Thu Aug 31 2017

@author: N1705165D (Manaar)
"""

import parameters as param
import random

def generate_benign_data():
    train_benign = random.sample(range(1, param.total_benign + 1), param.total_benign - param.num_test_benign)
    test_benign = []
    for item in range(1, param.total_benign + 1):
        if item not in train_benign:
            test_benign.append(item)
    with open("tempData/train_benign.txt", "w") as outFile:
        for fname in train_benign:
            with open("benign/prog"+str(fname)+".txt") as inFile:
                outFile.write(inFile.read())
    with open("tempData/test_benign.txt", "w") as outFile:
        for fname in test_benign:
            with open("benign/prog"+str(fname)+".txt") as inFile:
                outFile.write(inFile.read())
    with open("tempData/train_benign_program_list.txt", "w") as outFile:
        for item in train_benign:
            outFile.write("%s " % item)
    with open("tempData/test_benign_program_list.txt", "w") as outFile:
        for item in test_benign:
            outFile.write("%s " % item)

def generate_malware_data():
    train_malicious = random.sample(range(1, param.total_malware + 1), param.total_malware - param.num_test_malware)
    test_malicious = []
    for item in range(1, param.total_malware + 1):
        if item not in train_malicious:
            test_malicious.append(item)
    with open("tempData/train_malicious.txt", "w") as outFile:
        for fname in train_malicious:
            with open("malicious/prog"+str(fname)+".txt") as inFile:
                outFile.write(inFile.read())
    with open("tempData/test_malicious.txt", "w") as outFile:
        for fname in test_malicious:
            with open("malicious/prog"+str(fname)+".txt") as inFile:
                outFile.write(inFile.read())
    with open("tempData/train_malware_program_list.txt", "w") as outFile:
        for item in train_malicious:
            outFile.write("%s " % item)
    with open("tempData/test_malware_program_list.txt", "w") as outFile:
        for item in test_malicious:
            outFile.write("%s " % item)

def generate():
    generate_malware_data()
    with open("train_data.txt", "w") as outFile:
        with open("tempData/train_benign.txt") as inFile:
            content = inFile.readlines()
        content = [x.strip()+" 0\n" for x in content]
        for item in content:
            outFile.write(item.replace(" ", ","))
        with open("tempData/train_malicious.txt") as inFile:
            content = inFile.readlines()
        content = [x.strip()+" 1\n" for x in content]
        for item in content:
            outFile.write(item.replace(" ", ","))
    with open("test_data.txt", "w") as outFile:
        with open("tempData/test_benign.txt") as inFile:
            content = inFile.readlines()
        content = [x.strip()+" 0\n" for x in content]
        for item in content:
            outFile.write(item.replace(" ", ","))
        with open("tempData/test_malicious.txt") as inFile:
            content = inFile.readlines()
        content = [x.strip()+" 1\n" for x in content]
        for item in content:
            outFile.write(item.replace(" ", ","))