# -*- coding: utf-8 -*-
"""
Created on Thu Aug 31 2017

@author: N1705165D (Manaar)
"""

import dataSetCreator
import pandas as pd
import timeit
import numpy as np
from random import randint

from sklearn.neural_network import MLPClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.naive_bayes import GaussianNB
from sklearn.svm import SVC
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import f1_score

def dataset():
    dataSetCreator.generate()
    train_data = pd.read_csv("train_data.txt", header=None).as_matrix()
    test_data = pd.read_csv("test_data.txt", header=None).as_matrix()
    X_train = train_data[:, :-1]
    y_train = train_data[:, -1]
    X_test = test_data[:, :-1]
    y_test = test_data[:, -1]
    return X_train, X_test, y_train, y_test

clf = []
clf.append(MLPClassifier())
clf.append(LogisticRegression())
clf.append(GaussianNB())
clf.append(SVC(kernel="linear"))
clf.append(RandomForestClassifier())

score = [[] for i in range(5)]
train_time = [[] for i in range(5)]
prediction_time = [[] for i in range(5)]
for iteration in range(10):
    print(iteration)
    X_train, X_test, y_train, y_test = dataset()
#   target_process = randint(0, dataSetCreator.num_test_malware + dataSetCreator.num_test_malware)
#    target_data = X_test[(target_process * 50):((target_process + 1) * 50), :]
    for num in range(1):
        for i in range(5):
            
            start = timeit.default_timer()
            model = clf[i].fit(X_train, y_train)
            print(i)
            end = timeit.default_timer()
            time_to_train = (end - start)*1e3
            train_time[i].append(time_to_train)
            
            start = timeit.default_timer()
#            pred = model.predict(target_data)
            end = timeit.default_timer()
            time_to_predict = (end - start)*1e6
            prediction_time[i].append(time_to_predict)
            
            pred = model.predict(X_test)
            score[i].append(f1_score(y_test, pred))

average_train_time = []
average_prediction_time = []
average_score = []

for i in range(5):
    average_train_time.append(np.average(train_time[i]))
    average_prediction_time.append(np.average(prediction_time[i]))
    average_score.append(np.average(score[i]))

for i in range(5):
    print(average_train_time[i], average_prediction_time[i], average_score[i])