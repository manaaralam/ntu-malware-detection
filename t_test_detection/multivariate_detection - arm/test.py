# -*- coding: utf-8 -*-
"""
Created on Sat Sep  9 03:41:17 2017

@author: Manaar
"""

import main
import numpy as np
import scipy.stats

data1 = [[36.5, 72.0, 18.0], [36.6, 82.0, 4.0], [38.2, 65.0, 29.0], [37.6, 82.0, 12.0], [37.0, 68.0, 25.0], [37.9, 82.0, 27.0], [37.4, 80.0, 25.0], [35.2, 93.0, 8.0], [38.2, 65.0, 2.0], [37.5, 66.0, 11.0], [35.8, 70.0, 3.0], [37.4, 76.0, 13.0], [37.2, 83.0, 29.0], [36.5, 68.0, 24.0], [38.3, 77.0, 12.0], [37.5, 66.0, 28.0], [36.0, 79.0, 14.0], [36.9, 73.0, 12.0], [39.3, 76.0, 2.0], [38.8, 67.0, 13.0]]
data2 = [[40.9, 54.0, 14.0], [39.5, 75.0, 18.0], [39.4, 57.0, 24.0], [38.2, 71.0, 24.0], [39.7, 65.0, 22.0], [38.9, 49.0, 30.0], [38.6, 58.0, 25.0], [39.9, 52.0, 17.0], [41.3, 62.0, 18.0], [38.1, 57.0, 20.0], [39.6, 78.0, 19.0], [37.1, 92.0, 15.0], [39.5, 63.0, 13.0], [40.3, 52.0, 25.0], [41.5, 46.0, 27.0], [39.3, 56.0, 14.0], [37.6, 86.0, 16.0], [40.6, 48.0, 21.0]]
n1 = len(data1)
n2 = len(data2)
matrix1 = np.matrix(data1)
matrix2 = np.matrix(data2)
mu1 = matrix1.sum(0) / n1
mu2 = matrix2.sum(0) / n2
diff = mu1 - mu2
diff_t = diff.transpose()
sigma1 = main.get_cov_matrix(matrix1)
sigma2 = main.get_cov_matrix(matrix2)
combined_sigma = main.get_combined_sigma(sigma1, n1, sigma2, n2)
inv_combined_sigma = np.linalg.inv(combined_sigma)
n = n1 + n2 -1
k = len(data1[0])
T = np.array(np.matmul(np.matmul(diff, inv_combined_sigma), diff_t))[0][0]
F_value = ((n - k) / (k * (n - 1))) * T

sum1 = (np.matmul(np.matmul(np.matmul(np.matmul(diff, inv_combined_sigma), np.divide(sigma1, n1)), inv_combined_sigma), diff_t))/T
sum2 = (np.matmul(np.matmul(np.matmul(np.matmul(diff, inv_combined_sigma), np.divide(sigma2, n2)), inv_combined_sigma), diff_t))/T
sum1 = np.array(sum1)[0][0]
sum2 = np.array(sum2)[0][0]
m_t = ((sum1**2)/(n1 - 1))+((sum2**2)/(n2 - 1))
m = 1/m_t
df1 = k
df2 = int(round(m))

alpha = 0.05
F_critical = scipy.stats.f.ppf(q=1-alpha, dfn=df1, dfd=df2)