# -*- coding: utf-8 -*-
"""
Created on Sat Sep 23 18:27:09 2017

@author: N1705165D
"""

import pandas as pd
import matplotlib.pyplot as plt

t_crit = 1.2902499038829387

benign1 = pd.read_csv("aes.txt", header=None, sep=" ").as_matrix()
benign2 = pd.read_csv("adpcm.txt", header=None, sep=" ").as_matrix()
malware = pd.read_csv("442a98010abf2ecb069981e699bbd6e400aa784ea73bec8d7d86cabef4e731.txt", header=None, sep=" ").as_matrix()

b1 = benign1[:, 3]
b2 = benign2[:, 3]
m1 = malware[:, 3]

plt.hist(b1, label = "AES", bins = 40, normed = 1, color='k')
plt.hist(m1, label = "Malware", bins = 40, normed = 1, color='salmon')
plt.legend(loc="upper right")
plt.xlabel("cycles")
plt.ylabel("probability")
plt.title("Probability Density of cache-misses for 'netstat' in presence of AES and Malware \n t-score = -18.1522", fontsize = 10)
#plt.show()
#plt.tight_layout()
plt.rcParams['xtick.labelsize'] = 9
plt.rcParams['ytick.labelsize'] = 9
plt.savefig("ncm.png", bbox_inches = 'tight')
plt.close()

plt.hist(b1, label = "AES", bins = 40, normed = 1, color='k')
plt.hist(b2, label = "ADPCM", bins = 40, normed = 1, color='#66cdaa')
plt.legend(loc="upper right")
plt.xlabel("cycles")
plt.ylabel("probability")
plt.title("Probability Density of cache-misses for 'netstat' in presence of AES and ADPCM \n t-score = -1.2517", fontsize = 10)
#plt.show()
#plt.tight_layout()
plt.rcParams['xtick.labelsize'] = 9
plt.rcParams['ytick.labelsize'] = 9
plt.savefig("ncb.png", bbox_inches = 'tight')
plt.close()


b1 = benign1[:, 28]
b2 = benign2[:, 28]
m1 = malware[:, 28]

m1 = m1 - 7500
plt.hist(b1, label = "AES", bins = 40, normed = 1, color='k')
plt.hist(m1, label = "Malware", bins = 40, normed = 1, color='salmon')
plt.legend(loc="upper right")
plt.xlabel("branch-misses")
plt.ylabel("probability")
plt.title("Probability Density of cache-misses for 'netstat' in presence of AES and Malware \n t-score = -1.2761", fontsize = 10)
#plt.show()
#plt.tight_layout()
plt.rcParams['xtick.labelsize'] = 9
plt.rcParams['ytick.labelsize'] = 9
plt.savefig("nbm.png", bbox_inches = 'tight')
plt.close()

plt.hist(b1, label = "AES", bins = 40, normed = 1, color='k')
plt.hist(b2, label = "ADPCM", bins = 40, normed = 1, color='#66cdaa')
plt.legend(loc="upper right")
plt.xlabel("branch-misses")
plt.ylabel("probability")
plt.title("Probability Density of cache-misses for 'netstat' in presence of AES and ADPCM \n t-score = -1.1451", fontsize = 10)
#plt.show()
#plt.tight_layout()
plt.rcParams['xtick.labelsize'] = 9
plt.rcParams['ytick.labelsize'] = 9
plt.savefig("nbb.png", bbox_inches = 'tight')
plt.close()