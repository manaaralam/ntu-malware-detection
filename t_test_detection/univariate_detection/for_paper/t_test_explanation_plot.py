# -*- coding: utf-8 -*-
"""
Created on Sat Sep 23 18:27:09 2017

@author: N1705165D
"""

import pandas as pd
import matplotlib.pyplot as plt

t_crit = 3.86460985

benign1 = pd.read_csv("aes.txt", header=None, sep=" ").as_matrix()
benign2 = pd.read_csv("adpcm.txt", header=None, sep=" ").as_matrix()
malware = pd.read_csv("442a98010abf2ecb069981e699bbd6e400aa784ea73bec8d7d86cabef4e731.txt", header=None, sep=" ").as_matrix()

b1 = benign1[:, 3]
b2 = benign2[:, 3]
m1 = malware[:, 3]

plt.hist(b1, label = "AES", bins = 25, normed = 1, color='g')
plt.hist(m1, label = "Malware", bins = 25, normed = 1, color='r')
plt.legend(loc="upper right")
plt.xlabel("cycles")
plt.ylabel("probability")
plt.title("Probability Density of cache-misses for 'netstat' in presence of AES and Malware \n t-score = -18.1522", fontsize = 10)
#plt.show()
plt.tight_layout()
plt.rcParams['xtick.labelsize'] = 6
plt.rcParams['ytick.labelsize'] = 6
plt.savefig("ncm.png")
plt.close()

plt.hist(b1, label = "AES", bins = 25, normed = 1, color='g')
plt.hist(b2, label = "ADPCM", bins = 25, normed = 1, color='y')
plt.legend(loc="upper right")
plt.xlabel("cycles")
plt.ylabel("probability")
plt.title("Probability Density of cache-misses for 'netstat' in presence of AES and ADPCM \n t-score = -1.5517", fontsize = 10)
#plt.show()
plt.tight_layout()
plt.rcParams['xtick.labelsize'] = 6
plt.rcParams['ytick.labelsize'] = 6
plt.savefig("ncb.png")
plt.close()

b1 = benign1[:, 2]
b2 = benign2[:, 2]
m1 = malware[:, 2]

plt.hist(b1, label = "AES", bins = 25, normed = 1, color='g')
plt.hist(m1, label = "Malware", bins = 25, normed = 1, color='r')
plt.legend(loc="upper right")
plt.xlabel("cycles")
plt.ylabel("probability")
plt.title("Probability Density of cache-misses for 'who' in presence of AES and Malware \n t-score = 2.2365", fontsize = 10)
#plt.show()
plt.tight_layout()
plt.rcParams['xtick.labelsize'] = 6
plt.rcParams['ytick.labelsize'] = 6
plt.savefig("wcm.png")
plt.close()

plt.hist(b1, label = "AES", bins = 25, normed = 1, color='g')
plt.hist(b2, label = "ADPCM", bins = 25, normed = 1, color='y')
plt.legend(loc="upper right")
plt.xlabel("cycles")
plt.ylabel("probability")
plt.title("Probability Density of cache-misses for 'who' in presence of AES and ADPCM \n t-score = -1.2318", fontsize = 10)
#plt.show()
plt.tight_layout()
plt.rcParams['xtick.labelsize'] = 6
plt.rcParams['ytick.labelsize'] = 6
plt.savefig("wcb.png")
plt.close()

b1 = benign1[:, 28]
b2 = benign2[:, 28]
m1 = malware[:, 28] - 10000

plt.hist(b1, label = "AES", bins = 25, normed = 1, color='g')
plt.hist(m1, label = "Malware", bins = 25, normed = 1, color='r')
plt.legend(loc="upper right")
plt.xlabel("branch-misses")
plt.ylabel("probability")
plt.title("Probability Density of cache-misses for 'netstat' in presence of AES and Malware \n t-score = -3.7617", fontsize = 10)
#plt.show()
plt.tight_layout()
plt.rcParams['xtick.labelsize'] = 6
plt.rcParams['ytick.labelsize'] = 6
plt.savefig("nbm.png")
plt.close()

plt.hist(b1, label = "AES", bins = 25, normed = 1, color='g')
plt.hist(b2, label = "ADPCM", bins = 25, normed = 1, color='y')
plt.legend(loc="upper right")
plt.xlabel("branch-misses")
plt.ylabel("probability")
plt.title("Probability Density of cache-misses for 'netstat' in presence of AES and ADPCM \n t-score = -3.4501", fontsize = 10)
#plt.show()
plt.tight_layout()
plt.rcParams['xtick.labelsize'] = 6
plt.rcParams['ytick.labelsize'] = 6
plt.savefig("nbb.png")
plt.close()