# -*- coding: utf-8 -*-
"""
Created on Sat Sep 30 18:04:17 2017

@author: N1705165D
"""

import numpy as np

indicator = ["ls", "ps", "who", "netstat", "pwd"]
hpc = ["cycles", "instructions", "cache-references", "cache-misses", "branches", "branch-misses"]
iteration = 50

Matrix = [[0 for x in range(len(hpc) * len(indicator))] for y in range(iteration)]
Count = [[0 for x in range(len(hpc))] for y in range(len(indicator))]
Total = [[0 for x in range(len(hpc))] for y in range(len(indicator))]
Sum = [[0 for x in range(len(hpc))] for y in range(len(indicator))]
Average = [[0 for x in range(len(hpc))] for y in range(len(indicator))]

with open("hello_world.txt", "r") as inp:
    content = inp.readlines()

mod_content = []
for item in content:
    mod_content.append(item.replace("<not counted>", "0"))

for item in mod_content:
    item = item.strip()
    if item.startswith("Performance"):
        ind = item.split("'")[1]
        ind_index = indicator.index(ind)
    elif item != "":
        data = item.split()
        h = data[1]
        if h in hpc:
            entry = int(data[0].replace(",",""))
            hpc_index = hpc.index(h)
            col = ind_index + len(indicator) * hpc_index
            row = Count[ind_index][hpc_index]
            Matrix[row][col] = entry
            if entry!=0:
                Total[ind_index][hpc_index] += 1
            Count[ind_index][hpc_index] += 1
            Sum[ind_index][hpc_index] += entry

for row in range(len(indicator)):
    for col in range(len(hpc)):
        Average[row][col] = int(Sum[row][col] / Total[row][col])

for r in range(iteration):
    for c in range(30):
        if Matrix[r][c] == 0:
            h_i = int(c/5)
            i_i = c - 5 * h_i
            Matrix[r][c] = Average[i_i][h_i]

np.savetxt("prog55.txt", Matrix, fmt="%0.1f")